<?xml version="1.0" encoding="UTF-8"?>
<hdevelop file_version="1.1" halcon_version="12.0">
<procedure name="main">
<interface/>
<body>
<c>* 辅助程序，创建模板</c>
<l>get_current_dir (DirName)</l>
<l>list_image_files (DirName, 'default', [], ImageFiles)</l>
<l>read_image (ImageTemp, ImageFiles[0])</l>
<l>get_image_size (ImageTemp, WidthTemp, HeightTemp)</l>
<l>dev_close_window ()</l>
<l>dev_open_window (0, 0, WidthTemp/4, HeightTemp/4, 'black', WindowHandleTemp)</l>
<l>dev_display (ImageTemp)</l>
<l>draw_rectangle1(WindowHandleTemp, Row1, Column1, Row2, Column2)</l>
<l>gen_rectangle1 (Rectangle, Row1, Column1, Row2, Column2)</l>
<l>reduce_domain (ImageTemp, Rectangle, ImageReduced)</l>
<l>crop_domain (ImageReduced, ImagePart)</l>
<l>create_ncc_model (ImagePart, 'auto', -0.39, 0.79, 'auto', 'use_polarity', ModelIDTemp)</l>
<l>write_ncc_model (ModelIDTemp, 'ModelData')</l>
<l>clear_ncc_model (ModelIDTemp)</l>
<l>dev_close_window ()</l>
<c></c>
<c>* 主程序，把图片放在程序同一目录即可，不用在乎图片名称</c>
<l>read_ncc_model ('ModelData', ModelID)</l>
<l>open_file ('data.csv', 'append', FileHandle)</l>
<l>* fnew_line (FileHandle)</l>
<l>get_current_dir (DirName)</l>
<l>list_image_files (DirName, 'default', [], ImageFiles)</l>
<l>for Index := 1 to |ImageFiles| by 1</l>
<l>    read_image (Image, ImageFiles[Index - 1])</l>
<l>    get_image_size (Image, Width, Height)</l>
<l>    dev_close_window ()</l>
<l>    dev_open_window (0, 0, Width/4, Height/4, 'black', WindowHandle)</l>
<l>    dev_display (Image)</l>
<l>    find_ncc_model (Image, ModelID, -0.39, 0.78, 0.8, 1, 0.5, 'true', 0, Row, Column, Angle, Score)</l>
<l>    if (|Row| &gt; 0 and |Column| &gt; 0)</l>
<l>        disp_cross (WindowHandle, Row, Column, 60, 0)</l>
<l>        fwrite_string (FileHandle, 'X=' + Column + ',' + 'Y=' + Row)</l>
<l>        fnew_line (FileHandle)</l>
<l>    endif</l>
<l>endfor</l>
<l>clear_ncc_model (ModelID)</l>
<l>close_file (FileHandle)</l>
</body>
<docu id="main">
<parameters/>
</docu>
</procedure>
</hdevelop>
